<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Uploader Mode-Specific UI Test</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: #f9fafb;
        }
        
        .test-section {
            background: white;
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .test-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #1f2937;
        }
        
        .test-description {
            color: #6b7280;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        
        .controls {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 200ms;
        }
        
        .btn:hover {
            background: #f3f4f6;
            border-color: #9ca3af;
        }
        
        .btn.primary {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .btn.primary:hover {
            background: #2563eb;
        }
        
        .status {
            margin: 1rem 0;
            padding: 0.75rem;
            border-radius: 6px;
            font-size: 0.875rem;
        }
        
        .status.info {
            background: #eff6ff;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }
        
        .status.success {
            background: #f0fdf4;
            color: #166534;
            border: 1px solid #bbf7d0;
        }
        
        .event-log {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.75rem;
        }
        
        .event-entry {
            margin: 0.25rem 0;
            padding: 0.25rem;
            border-radius: 3px;
        }
        
        .event-entry.mode-changed {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .event-entry.files-adapted {
            background: #fef3c7;
            color: #92400e;
        }
    </style>
</head>
<body>
    <h1>File Uploader Mode-Specific UI Test</h1>
    <p>This page tests the mode-specific UI rendering and instructions for the dual-mode file uploader component.</p>

    <div class="test-section">
        <h2 class="test-title">Basic Mode-Specific UI Test</h2>
        <p class="test-description">
            Test the basic mode-specific UI rendering with different icons, instructions, and visual indicators.
            Toggle between single and batch modes to see the UI changes.
        </p>
        
        <file-uploader id="basic-test" 
                      accept=".pdf" 
                      max-size="50MB" 
                      default-mode="single"
                      remember-preference="true">
        </file-uploader>
        
        <div class="controls">
            <button class="btn" onclick="toggleMode('basic-test')">Toggle Mode</button>
            <button class="btn" onclick="setMode('basic-test', 'single')">Set Single Mode</button>
            <button class="btn" onclick="setMode('basic-test', 'batch')">Set Batch Mode</button>
            <button class="btn" onclick="getCurrentMode('basic-test')">Get Current Mode</button>
        </div>
        
        <div id="basic-status" class="status info">
            Current mode: <span id="basic-mode">single</span>
        </div>
    </div>

    <div class="test-section">
        <h2 class="test-title">Transition Animation Test</h2>
        <p class="test-description">
            Test the smooth transition animations between mode changes. Watch for visual feedback during mode switches.
        </p>
        
        <file-uploader id="animation-test" 
                      accept=".pdf,.docx,.xlsx" 
                      max-size="100MB" 
                      default-mode="batch"
                      remember-preference="false">
        </file-uploader>
        
        <div class="controls">
            <button class="btn primary" onclick="rapidToggle('animation-test')">Rapid Toggle Test</button>
            <button class="btn" onclick="testTransitionStates('animation-test')">Test Transition States</button>
        </div>
        
        <div id="animation-status" class="status info">
            Animation test ready
        </div>
    </div>

    <div class="test-section">
        <h2 class="test-title">Accessibility Test</h2>
        <p class="test-description">
            Test mode-specific ARIA labels and screen reader announcements. Use keyboard navigation to test accessibility.
        </p>
        
        <file-uploader id="accessibility-test" 
                      accept=".pdf" 
                      max-size="25MB" 
                      default-mode="single">
        </file-uploader>
        
        <div class="controls">
            <button class="btn" onclick="testAriaLabels('accessibility-test')">Test ARIA Labels</button>
            <button class="btn" onclick="testKeyboardNavigation('accessibility-test')">Focus Toggle</button>
        </div>
        
        <div id="accessibility-status" class="status info">
            Use Tab to navigate, Space/Enter to toggle
        </div>
    </div>

    <div class="test-section">
        <h2 class="test-title">Event Monitoring</h2>
        <p class="test-description">
            Monitor events emitted during mode changes and UI updates.
        </p>
        
        <div id="event-log" class="event-log">
            <div class="event-entry">Event log initialized...</div>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="clearEventLog()">Clear Log</button>
        </div>
    </div>

    <script type="module">
        import { FileUploader } from './js/components/file-uploader.js';
        
        // Global functions for testing
        window.toggleMode = function(id) {
            const uploader = document.getElementById(id);
            if (uploader) {
                const success = uploader.toggleMode();
                updateModeStatus(id, uploader.getMode());
                logEvent('mode-changed', `Toggle ${success ? 'successful' : 'failed'}: ${uploader.getMode()}`);
            }
        };
        
        window.setMode = function(id, mode) {
            const uploader = document.getElementById(id);
            if (uploader) {
                const success = uploader.setMode(mode);
                updateModeStatus(id, uploader.getMode());
                logEvent('mode-changed', `Set mode ${success ? 'successful' : 'failed'}: ${mode} -> ${uploader.getMode()}`);
            }
        };
        
        window.getCurrentMode = function(id) {
            const uploader = document.getElementById(id);
            if (uploader) {
                const mode = uploader.getMode();
                logEvent('info', `Current mode: ${mode}`);
                alert(`Current mode: ${mode}`);
            }
        };
        
        window.rapidToggle = function(id) {
            const uploader = document.getElementById(id);
            if (uploader) {
                let count = 0;
                const interval = setInterval(() => {
                    uploader.toggleMode();
                    count++;
                    if (count >= 6) {
                        clearInterval(interval);
                        logEvent('info', 'Rapid toggle test completed');
                    }
                }, 600);
            }
        };
        
        window.testTransitionStates = function(id) {
            const uploader = document.getElementById(id);
            if (uploader) {
                logEvent('info', 'Testing transition states...');
                uploader.setMode('single');
                setTimeout(() => uploader.setMode('batch'), 300);
                setTimeout(() => uploader.setMode('single'), 900);
                setTimeout(() => logEvent('info', 'Transition state test completed'), 1500);
            }
        };
        
        window.testAriaLabels = function(id) {
            const uploader = document.getElementById(id);
            if (uploader) {
                const uploadArea = uploader.querySelector('.upload-area');
                if (uploadArea) {
                    const ariaLabel = uploadArea.getAttribute('aria-label');
                    const ariaDescribedBy = uploadArea.getAttribute('aria-describedby');
                    logEvent('info', `ARIA Label: ${ariaLabel}`);
                    logEvent('info', `ARIA Described By: ${ariaDescribedBy}`);
                    alert(`ARIA Label: ${ariaLabel}`);
                }
            }
        };
        
        window.testKeyboardNavigation = function(id) {
            const uploader = document.getElementById(id);
            if (uploader) {
                const toggleSwitch = uploader.querySelector('.toggle-switch');
                if (toggleSwitch) {
                    toggleSwitch.focus();
                    logEvent('info', 'Toggle switch focused - use Space or Enter to activate');
                }
            }
        };
        
        window.clearEventLog = function() {
            const log = document.getElementById('event-log');
            log.innerHTML = '<div class="event-entry">Event log cleared...</div>';
        };
        
        function updateModeStatus(id, mode) {
            const statusElement = document.getElementById(id.replace('-test', '-mode'));
            if (statusElement) {
                statusElement.textContent = mode;
            }
        }
        
        function logEvent(type, message) {
            const log = document.getElementById('event-log');
            const entry = document.createElement('div');
            entry.className = `event-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
        
        // Set up event listeners for all uploaders
        document.addEventListener('DOMContentLoaded', () => {
            const uploaders = document.querySelectorAll('file-uploader');
            
            uploaders.forEach(uploader => {
                uploader.addEventListener('mode-changed', (e) => {
                    logEvent('mode-changed', `Mode changed: ${e.detail.oldMode} -> ${e.detail.newMode}`);
                    updateModeStatus(uploader.id, e.detail.newMode);
                });
                
                uploader.addEventListener('files-adapted', (e) => {
                    logEvent('files-adapted', `Files adapted for ${e.detail.mode} mode: ${e.detail.originalFiles.length} -> ${e.detail.adaptedFiles.length}`);
                });
                
                uploader.addEventListener('files-selected', (e) => {
                    logEvent('info', `Files selected in ${e.detail.mode} mode: ${e.detail.files.length} files`);
                });
                
                // Initialize mode status
                updateModeStatus(uploader.id, uploader.getMode());
            });
        });
    </script>
</body>
</html>