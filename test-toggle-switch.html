<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Uploader Toggle Switch Test</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: #f9fafb;
        }
        
        .test-container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        h1 {
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        h2 {
            color: #374151;
            margin-bottom: 1rem;
            font-size: 1.25rem;
        }
        
        .test-info {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            color: #1e40af;
        }
        
        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        button {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            font-size: 0.875rem;
        }
        
        button:hover {
            background: #f3f4f6;
        }
        
        .status {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 1rem;
            font-family: monospace;
            font-size: 0.875rem;
        }
        
        .error {
            background: #fef2f2;
            border-color: #fecaca;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <h1>File Uploader Toggle Switch Test</h1>
    
    <div class="test-container">
        <h2>Basic Toggle Switch</h2>
        <div class="test-info">
            Test the toggle switch functionality between single file and batch files mode.
        </div>
        
        <div class="controls">
            <button onclick="testGetMode()">Get Current Mode</button>
            <button onclick="testSetSingleMode()">Set Single Mode</button>
            <button onclick="testSetBatchMode()">Set Batch Mode</button>
            <button onclick="testToggleMode()">Toggle Mode</button>
            <button onclick="testDisableToggle()">Disable Toggle</button>
            <button onclick="testEnableToggle()">Enable Toggle</button>
        </div>
        
        <file-uploader 
            id="uploader1"
            accept=".pdf"
            max-size="50MB"
            default-mode="single"
            remember-preference="true">
        </file-uploader>
        
        <div id="status1" class="status">Ready for testing...</div>
    </div>
    
    <div class="test-container">
        <h2>Pre-configured Batch Mode</h2>
        <div class="test-info">
            This uploader starts in batch mode with toggle disabled.
        </div>
        
        <file-uploader 
            id="uploader2"
            accept=".pdf,.docx,.xlsx"
            max-size="100MB"
            default-mode="batch"
            toggle-disabled>
        </file-uploader>
        
        <div id="status2" class="status">Toggle is disabled on this uploader.</div>
    </div>
    
    <div class="test-container">
        <h2>Legacy Multiple Attribute</h2>
        <div class="test-info">
            This uploader uses the legacy 'multiple' attribute which should set initial batch mode.
        </div>
        
        <file-uploader 
            id="uploader3"
            accept=".pdf"
            multiple
            max-size="25MB">
        </file-uploader>
        
        <div id="status3" class="status">Should start in batch mode due to 'multiple' attribute.</div>
    </div>

    <script type="module">
        import { FileUploader } from './js/components/file-uploader.js';
        
        // Wait for components to be ready
        window.addEventListener('DOMContentLoaded', () => {
            const uploader1 = document.getElementById('uploader1');
            const uploader2 = document.getElementById('uploader2');
            const uploader3 = document.getElementById('uploader3');
            
            // Add event listeners for testing
            uploader1.addEventListener('mode-changed', (e) => {
                updateStatus('status1', `Mode changed: ${e.detail.oldMode} → ${e.detail.newMode}`);
            });
            
            uploader1.addEventListener('files-selected', (e) => {
                updateStatus('status1', `Files selected: ${e.detail.files.length} files in ${e.detail.mode} mode`);
            });
            
            uploader1.addEventListener('files-adapted', (e) => {
                updateStatus('status1', `Files adapted: ${e.detail.originalFiles.length} → ${e.detail.adaptedFiles.length} files`);
            });
            
            // Test functions
            window.testGetMode = () => {
                const mode = uploader1.getMode();
                updateStatus('status1', `Current mode: ${mode}`);
            };
            
            window.testSetSingleMode = () => {
                const success = uploader1.setMode('single');
                updateStatus('status1', `Set single mode: ${success ? 'success' : 'failed'}`);
            };
            
            window.testSetBatchMode = () => {
                const success = uploader1.setMode('batch');
                updateStatus('status1', `Set batch mode: ${success ? 'success' : 'failed'}`);
            };
            
            window.testToggleMode = () => {
                const oldMode = uploader1.getMode();
                const success = uploader1.toggleMode();
                const newMode = uploader1.getMode();
                updateStatus('status1', `Toggle mode: ${oldMode} → ${newMode} (${success ? 'success' : 'failed'})`);
            };
            
            window.testDisableToggle = () => {
                uploader1.setAttribute('toggle-disabled', '');
                updateStatus('status1', 'Toggle disabled');
            };
            
            window.testEnableToggle = () => {
                uploader1.removeAttribute('toggle-disabled');
                updateStatus('status1', 'Toggle enabled');
            };
            
            function updateStatus(statusId, message) {
                const statusEl = document.getElementById(statusId);
                const timestamp = new Date().toLocaleTimeString();
                statusEl.textContent = `[${timestamp}] ${message}`;
                statusEl.className = 'status';
            }
            
            // Initial status
            setTimeout(() => {
                updateStatus('status1', `Initial mode: ${uploader1.getMode()}`);
                updateStatus('status2', `Initial mode: ${uploader2.getMode()}`);
                updateStatus('status3', `Initial mode: ${uploader3.getMode()}`);
            }, 100);
        });
    </script>
</body>
</html>